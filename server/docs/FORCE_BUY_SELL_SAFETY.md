# üîí Force Buy/Sell Safety Analysis

## ‚úÖ –ó–∞—Ö–∏—Å—Ç–∏, —è–∫—ñ –≤–∂–µ —î –≤ –∫–æ–¥—ñ:

### **1. Force Buy (–ü–æ–∫—É–ø–∫–∞)**

#### ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—É SOL
- **–†—è–¥–∫–∏ 414-421**: –ü–µ—Ä–µ–≤—ñ—Ä—è—î –±–∞–ª–∞–Ω—Å SOL –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ—é
- **–ó–∞—Ö–∏—Å—Ç**: –ù–µ –¥–æ–∑–≤–æ–ª—è—î –∫—É–ø–∏—Ç–∏, —è–∫—â–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ SOL
- **–ë—É—Ñ–µ—Ä**: –ó–∞–ª–∏—à–∞—î 5% SOL –¥–ª—è –∫–æ–º—ñ—Å—ñ–π (`sol_need > balance_sol * 0.95`)

#### ‚úÖ Honeypot Check (–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ honeypot)
- **–†—è–¥–∫–∏ 423-521**: –°–∏–º—É–ª—é—î –ø—Ä–æ–¥–∞–∂—É –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ—é
- **–õ–æ–≥—ñ–∫–∞**: –Ø–∫—â–æ –Ω–µ –º–æ–∂–Ω–∞ —Å–∏–º—É–ª—é–≤–∞—Ç–∏ –ø—Ä–æ–¥–∞–∂—É ‚Üí honeypot ‚Üí –ø–æ–∫—É–ø–∫–∞ –±–ª–æ–∫—É—î—Ç—å—Å—è
- **Retry**: –î–æ 3 —Å–ø—Ä–æ–± –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é 1-3 —Å–µ–∫—É–Ω–¥–∏
- **–ó–∞—Ö–∏—Å—Ç**: –ó–∞–ø–æ–±—ñ–≥–∞—î –≤—Ç—Ä–∞—Ç—ñ –∫–æ—à—Ç—ñ–≤ –Ω–∞ honeypot —Ç–æ–∫–µ–Ω–∞—Ö

#### ‚úÖ Slippage Protection
- **–†—è–¥–∫–∏ 533-599**: Retry logic –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º slippage
- **–†—ñ–≤–Ω—ñ**: 5%, 6% (—Ç—ñ–ª—å–∫–∏ 2 —Å–ø—Ä–æ–±–∏, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ rate limiting)
- **–ó–∞—Ö–∏—Å—Ç**: –Ø–∫—â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ slippage ‚Üí —Å–ø—Ä–æ–±–∞ –∑ –±—ñ–ª—å—à–∏–º slippage

#### ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
- **–†—è–¥–∫–∏ 59-129**: `_sign_and_send_transaction` –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ –ø–æ–º–∏–ª–∫–∏
- **–¢–∏–ø–∏ –ø–æ–º–∏–ª–æ–∫**: HTTP errors, JSON parse errors, transaction errors, slippage errors
- **Retry logic**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π retry –¥–ª—è slippage errors

---

### **2. Force Sell (–ü—Ä–æ–¥–∞–∂–∞)**

#### ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É —Ç–æ–∫–µ–Ω—ñ–≤
- **–†—è–¥–∫–∏ 916-932**: –û—Ç—Ä–∏–º—É—î —Ä–µ–∞–ª—å–Ω–∏–π –±–∞–ª–∞–Ω—Å —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –∫–æ—à–µ–ª—å–∫–∞
- **–ó–∞—Ö–∏—Å—Ç**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º—ñ–Ω—ñ–º—É–º –∑ DB amount —ñ real balance
- **–ü—Ä–∏—á–∏–Ω–∞**: –ó–∞–ø–æ–±—ñ–≥–∞—î –ø—Ä–æ–¥–∞–∂—É –±—ñ–ª—å—à–µ —Ç–æ–∫–µ–Ω—ñ–≤, –Ω—ñ–∂ —î –Ω–∞ –∫–æ—à–µ–ª—å–∫—É (—á–µ—Ä–µ–∑ rounding, fees, —Ç–æ—â–æ)

#### ‚úÖ Retry Logic –∑—ñ –∑–º–µ–Ω—à–µ–Ω–Ω—è–º –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
- **–†—è–¥–∫–∏ 942-969**: –î–æ 10 —Å–ø—Ä–æ–±, –∑–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ 1% –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –ø–æ–º–∏–ª—Ü—ñ
- **–ó–∞—Ö–∏—Å—Ç**: –Ø–∫—â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å ‚Üí —Å–ø—Ä–æ–±–∞ –∑ –º–µ–Ω—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ç–æ–∫–µ–Ω—ñ–≤
- **–ó–∞—Ç—Ä–∏–º–∫–∞**: 1-3 —Å–µ–∫—É–Ω–¥–∏ –º—ñ–∂ —Å–ø—Ä–æ–±–∞–º–∏ (—â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ rate limiting)

#### ‚úÖ Slippage Protection
- **–†—è–¥–∫–∏ 680-779**: Retry logic –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º slippage (6%, 7%, 8%, 9%, 10%)
- **–ó–∞—Ö–∏—Å—Ç**: –Ø–∫—â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ slippage ‚Üí —Å–ø—Ä–æ–±–∞ –∑ –±—ñ–ª—å—à–∏–º slippage

#### ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
- **–†—è–¥–∫–∏ 59-129**: `_sign_and_send_transaction` –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ –ø–æ–º–∏–ª–∫–∏
- **–¢–∏–ø–∏ –ø–æ–º–∏–ª–æ–∫**: HTTP errors, JSON parse errors, transaction errors, slippage errors

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ä–∏–∑–∏–∫–∏:

### **1. –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î—Ç—å—Å—è**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è, –∞–ª–µ –Ω–µ —á–µ–∫–∞—î—Ç—å—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
- **–†–∏–∑–∏–∫**: –ú–æ–∂–ª–∏–≤–∞ –≤—Ç—Ä–∞—Ç–∞ –∫–æ—à—Ç—ñ–≤, —è–∫—â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å—Å—è
- **–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω**: –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `sendTransaction`, –∞–ª–µ –Ω–µ —á–µ–∫–∞—î—Ç—å—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Å—Ç–∞—Ç—É—Å—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó —á–µ—Ä–µ–∑ `confirmTransaction` –∞–±–æ `getSignatureStatuses`

### **2. Front-running**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–ª–∏–≤–∏–π front-running (—Ö—Ç–æ—Å—å –∫—É–ø—É—î/–ø—Ä–æ–¥–∞—î –ø–µ—Ä–µ–¥ –≤–∞—à–æ—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—î—é)
- **–†–∏–∑–∏–∫**: –ú–æ–∂–ª–∏–≤–∞ –≤—Ç—Ä–∞—Ç–∞ –∫–æ—à—Ç—ñ–≤ —á–µ—Ä–µ–∑ –∑–º—ñ–Ω—É —Ü—ñ–Ω–∏
- **–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω**: –ù–µ–º–∞—î –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ front-running
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `advanced_force_sell` –∑ `min_price_usd` –¥–ª—è –ø—Ä–æ–¥–∞–∂—É

### **3. Rate Limiting**
- **–ü—Ä–æ–±–ª–µ–º–∞**: Jupiter API –º–∞—î rate limits
- **–†–∏–∑–∏–∫**: –ú–æ–∂–ª–∏–≤—ñ –∑–∞—Ç—Ä–∏–º–∫–∏ –∞–±–æ –ø–æ–º–∏–ª–∫–∏ —á–µ—Ä–µ–∑ rate limiting
- **–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω**: –Ñ `_wait_for_jupiter_rate_limit()`, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–µ rate limiting

### **4. –ü–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤**
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- **–†–∏–∑–∏–∫**: –ú–æ–∂–ª–∏–≤–∞ –≤—Ç—Ä–∞—Ç–∞ –∫–æ—à—Ç—ñ–≤, —è–∫—â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞, –∞–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –æ–±—Ä–æ–±–ª–µ–Ω–æ
- **–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω**: –Ñ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫, –∞–ª–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è —Å—Ç–∞—Ç—É—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Å—Ç–∞—Ç—É—Å—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –ø–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º –ë–î

---

## üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –±–µ–∑–ø–µ–∫–∏:

### **1. –î–æ–¥–∞—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**
```python
# –ü—ñ—Å–ª—è sendTransaction, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å:
async def confirm_transaction(signature: str, timeout: int = 30):
    """Wait for transaction confirmation"""
    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ getSignatureStatuses –∞–±–æ confirmTransaction
    # –ß–µ–∫–∞—Ç–∏ –¥–æ timeout —Å–µ–∫—É–Ω–¥
    # –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ True —è–∫—â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ, False —è–∫—â–æ –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ
```

### **2. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∂—É**
```python
# –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ advanced_force_sell –∑ min_price_usd
# –¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø—Ä–æ–¥–∞–∂—É –∑–∞ –∑–∞–Ω–∞–¥—Ç–æ –Ω–∏–∑—å–∫–æ—é —Ü—ñ–Ω–æ—é
```

### **3. –î–æ–¥–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**
- **–ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω**: –Ñ `log_trade_attempt`, –∞–ª–µ –Ω–µ –≤—Å—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –ª–æ–≥—É—é—Ç—å—Å—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –õ–æ–≥—É–≤–∞—Ç–∏ –≤—Å—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó (—É—Å–ø—ñ—à–Ω—ñ —Ç–∞ –Ω–µ–≤–¥–∞–ª—ñ) –∑ signature, amount, price

### **4. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –±–∞–ª–∞–Ω—Å—É –ø—ñ—Å–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó**
```python
# –ü—ñ—Å–ª—è –ø–æ–∫—É–ø–∫–∏: –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Ç–æ–∫–µ–Ω–∏ –¥—ñ–π—Å–Ω–æ –Ω–∞ –∫–æ—à–µ–ª—å–∫—É
# –ü—ñ—Å–ª—è –ø—Ä–æ–¥–∞–∂—É: –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ SOL –¥—ñ–π—Å–Ω–æ –Ω–∞ –∫–æ—à–µ–ª—å–∫—É
```

---

## üìä –í–∏—Å–Ω–æ–≤–æ–∫:

### ‚úÖ **–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏:**
1. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—É –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ—é/–ø—Ä–æ–¥–∞–∂–µ–º
2. ‚úÖ Honeypot check –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ—é
3. ‚úÖ Retry logic –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º slippage
4. ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
5. ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É —Ç–æ–∫–µ–Ω—ñ–≤ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∂–µ–º

### ‚ö†Ô∏è **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ä–∏–∑–∏–∫–∏:**
1. ‚ö†Ô∏è –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –º–æ–∂–µ –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏—Å—è (–Ω–µ —á–µ–∫–∞—î—Ç—å—Å—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è)
2. ‚ö†Ô∏è –ú–æ–∂–ª–∏–≤–∏–π front-running
3. ‚ö†Ô∏è –ú–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### üõ°Ô∏è **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
1. –î–æ–¥–∞—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –ø–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º –ë–î
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `advanced_force_sell` –∑ `min_price_usd` –¥–ª—è –ø—Ä–æ–¥–∞–∂—É
3. –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –±–∞–ª–∞–Ω—Å—É –ø—ñ—Å–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
4. –î–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–µ rate limiting

---

## üö® **–í–ê–ñ–õ–ò–í–û:**
- **Force buy/sell –æ–±—Ö–æ–¥–∏—Ç—å –≤—Å—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏** (TARGET_RETURN, plan_sell_*, —Ç–æ—â–æ)
- **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–±–µ—Ä–µ–∂–Ω–æ** - —Ü–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ç—Ä–∞—Ç–∏ –∫–æ—à—Ç—ñ–≤
- **–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–±–æ –≤ –µ–∫—Å—Ç—Ä–µ–Ω–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ—è—Ö
- **–î–ª—è –ø—Ä–æ–¥–∞–∂—É**: –ö—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `advanced_force_sell` –∑ `min_price_usd` –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ front-running

