# ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞

## ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: SQL –º—ñ–≥—Ä–∞—Ü—ñ—ó

**–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ SQL –º—ñ–≥—Ä–∞—Ü—ñ—ó –¥–æ –ë–î!**

–Ø–∫—â–æ –ë–î —â–µ –º–∞—î —Å—Ç–∞—Ä—ñ –ø–æ–ª—è `sim_*`, –∞ –∫–æ–¥ –æ—á—ñ–∫—É—î –Ω–æ–≤—ñ –ø–æ–ª—è, –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏.

### –®–≤–∏–¥–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É –ë–î:

```sql
-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—é—Ç—å —Å—Ç–∞—Ä—ñ –ø–æ–ª—è
SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'tokens' 
  AND column_name LIKE 'sim_%';

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—é—Ç—å –Ω–æ–≤—ñ –ø–æ–ª—è
SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'tokens' 
  AND column_name IN ('plan_sell_iteration', 'plan_sell_price_usd', 'wallet_id');

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞–∑–≤—É —Ç–∞–±–ª–∏—Ü—ñ
SELECT table_name 
FROM information_schema.tables 
WHERE table_name IN ('sim_wallets', 'wallets', 'sim_wallet_history', 'wallet_history');
```

### –Ø–∫—â–æ —Å—Ç–∞—Ä—ñ –ø–æ–ª—è —â–µ —ñ—Å–Ω—É—é—Ç—å:

**–í–∞—Ä—ñ–∞–Ω—Ç 1: –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑–∞—Ä–∞–∑ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)**

```bash
# 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–µ–∫–∞–ø
pg_dump -h localhost -U your_user -d crypto_db -f backup_before_migration_$(date +%Y%m%d_%H%M%S).sql

# 2. –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó (–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É!)
psql -h localhost -U your_user -d crypto_db -f server/migrations/rename_sim_wallet_history_to_wallet_history.sql
psql -h localhost -U your_user -d crypto_db -f server/migrations/20251106_tokens_cleanup.sql
psql -h localhost -U your_user -d crypto_db -f server/migrations/20251106_drop_sim_wallets.sql

# 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
psql -h localhost -U your_user -d crypto_db -c "SELECT column_name FROM information_schema.columns WHERE table_name = 'tokens' AND column_name LIKE 'sim_%';"
```

**–í–∞—Ä—ñ–∞–Ω—Ç 2: –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä –±–µ–∑ –º—ñ–≥—Ä–∞—Ü—ñ–π (–Ω–µ–±–µ–∑–ø–µ—á–Ω–æ)**

–Ø–∫—â–æ –≤–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ:
- `_v3_db_init.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å –Ω–æ–≤—ñ –ø–æ–ª—è (`ADD COLUMN IF NOT EXISTS`)
- –ö–æ–¥ –Ω–µ —á–∏—Ç–∞—î —Å—Ç–∞—Ä—ñ `sim_*` –ø–æ–ª—è (–ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ - –Ω–µ —á–∏—Ç–∞—î)
- –°—Ç–∞—Ä—ñ –ø–æ–ª—è –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –≤ –ë–î, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º—É—Ç—å—Å—è

–¢–æ –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä, –∞–ª–µ **—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –ø—ñ–∑–Ω—ñ—à–µ**.

---

## ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–¥—É

### 1. –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
```bash
cd server
python3 -m py_compile main.py _v2_buy_sell.py _v3_analyzer_jupiter.py
```
‚úÖ **–°—Ç–∞—Ç—É—Å:** –í—Å—ñ —Ñ–∞–π–ª–∏ –∫–æ–º–ø—ñ–ª—é—é—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

### 2. –Ü–º–ø–æ—Ä—Ç–∏
```bash
grep -r "from.*_v1_buy_sell\|import.*_v1_buy_sell" server/*.py
```
‚úÖ **–°—Ç–∞—Ç—É—Å:** –¢—ñ–ª—å–∫–∏ —Ç–∏–º—á–∞—Å–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏ –∑ `temp/_v1_buy_sell` (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)

### 3. –ó–≥–∞–¥–∫–∏ sim_* –≤ –∞–∫—Ç–∏–≤–Ω–æ–º—É –∫–æ–¥—ñ
```bash
grep -r "sim_buy\|sim_sell\|sim_wallets" server/*.py | grep -v "temp/" | grep -v "test_" | grep -v "#"
```
‚úÖ **–°—Ç–∞—Ç—É—Å:** –¢—ñ–ª—å–∫–∏ –≤ –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö (–Ω–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ä–æ–±–æ—Ç—É)

---

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

### –Ø–∫—â–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ:
```bash
./start.sh
```

### –Ø–∫—â–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó –ù–ï –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ:
```bash
# –°–µ—Ä–≤–µ—Ä –º–æ–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç–∏—Å—è, –∞–ª–µ:
# 1. –ù–æ–≤—ñ –ø–æ–ª—è –±—É–¥—É—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (_v3_db_init.py)
# 2. –°—Ç–∞—Ä—ñ –ø–æ–ª—è –∑–∞–ª–∏—à–∞—Ç—å—Å—è –≤ –ë–î (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –∞–ª–µ –∫—Ä–∞—â–µ –≤–∏–¥–∞–ª–∏—Ç–∏)
# 3. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –ø—ñ–∑–Ω—ñ—à–µ
./start.sh
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –°—Ç–≤–æ—Ä–µ–Ω–æ –±–µ–∫–∞–ø –ë–î (—è–∫—â–æ –ø–ª–∞–Ω—É—î—Ç–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó)
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—é –∫–æ–¥—É
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ —ñ–º–ø–æ—Ä—Ç–∏
- [ ] –í–∏—Ä—ñ—à–µ–Ω–æ: –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –∑–∞—Ä–∞–∑ —á–∏ –ø—ñ–∑–Ω—ñ—à–µ
- [ ] –ì–æ—Ç–æ–≤—ñ –¥–æ –∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤–µ—Ä–∞

---

## ‚ö†Ô∏è –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ –ø—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É

### –ü–æ–º–∏–ª–∫–∞: "column sim_* does not exist"
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–¥ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Å—Ç–∞—Ä—ñ –ø–æ–ª—è  
**–†—ñ—à–µ–Ω–Ω—è:** –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –Ω–µ–º–∞—î –∑–∞–ª–∏—à–∫—ñ–≤ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥—É

### –ü–æ–º–∏–ª–∫–∞: "relation sim_wallets does not exist"
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–¥ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å—Ç–∞—Ä–æ—ó —Ç–∞–±–ª–∏—Ü—ñ  
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `_v2_balance.py` —Ç–∞ —ñ–Ω—à—ñ —Ñ–∞–π–ª–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑–≤–µ—Ä–Ω–µ–Ω—å –¥–æ `sim_wallets`

### –ü–æ–º–∏–ª–∫–∞: "relation wallet_history does not exist"
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü—è —â–µ –Ω–µ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–∞  
**–†—ñ—à–µ–Ω–Ω—è:** –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é `rename_sim_wallet_history_to_wallet_history.sql`

---

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** 2025-11-06

